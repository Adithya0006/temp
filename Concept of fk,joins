Good question Adithya ðŸ‘ (this is important for backend + DBMS fundamentals, and very useful for your resume projects).

Iâ€™ll explain:

1. âœ… What is Foreign Key (concept clearly)


2. âœ… How to create tables with Foreign Keys in FastAPI (SQLAlchemy)


3. âœ… Simple example (Studentâ€“Department)


4. âœ… All types of joins with code + explanation



Weâ€™ll use:

FastAPI

SQLAlchemy ORM

SQLite (for simplicity)



---

1ï¸âƒ£ What is a Foreign Key? (Concept)

ðŸ”¹ Primary Key (PK)

A column that uniquely identifies each row in a table.

Example:

Department
------------
id (PK)
name

ðŸ”¹ Foreign Key (FK)

A column in one table that refers to the Primary Key of another table.

It creates a relationship between tables.

Example:

Student
------------
id (PK)
name
department_id (FK â†’ Department.id)

ðŸ‘‰ Meaning:

One Department can have many Students

Each Student belongs to one Department


This is called One-to-Many relationship


---

2ï¸âƒ£ Creating Tables with Foreign Keys in FastAPI

Install packages

pip install fastapi sqlalchemy uvicorn


---

ðŸ“ db.py (Database setup)

from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker, declarative_base

DATABASE_URL = "sqlite:///./test.db"

engine = create_engine(DATABASE_URL, connect_args={"check_same_thread": False})

SessionLocal = sessionmaker(bind=engine)
Base = declarative_base()


---

ðŸ“ models.py (Tables with Foreign Key)

from sqlalchemy import Column, Integer, String, ForeignKey
from sqlalchemy.orm import relationship
from db import Base

class Department(Base):
    __tablename__ = "departments"

    id = Column(Integer, primary_key=True, index=True)
    name = Column(String, unique=True)

    # Relationship
    students = relationship("Student", back_populates="department")


class Student(Base):
    __tablename__ = "students"

    id = Column(Integer, primary_key=True, index=True)
    name = Column(String)
    department_id = Column(Integer, ForeignKey("departments.id"))

    # Relationship
    department = relationship("Department", back_populates="students")


---

ðŸ”¥ What is happening here?

department_id = Column(Integer, ForeignKey("departments.id"))

Means:

> This column must match an existing id in departments table.




---

ðŸ”¥ relationship()

Used by SQLAlchemy ORM

Helps access related data easily


Example:

student.department.name


---

ðŸ“ main.py

from fastapi import FastAPI, Depends
from sqlalchemy.orm import Session
from db import SessionLocal, engine, Base
import models

Base.metadata.create_all(bind=engine)

app = FastAPI()

# Dependency
def get_db():
    db = SessionLocal()
    try:
        yield db
    finally:
        db.close()


@app.post("/departments/")
def create_department(name: str, db: Session = Depends(get_db)):
    dept = models.Department(name=name)
    db.add(dept)
    db.commit()
    db.refresh(dept)
    return dept


@app.post("/students/")
def create_student(name: str, department_id: int, db: Session = Depends(get_db)):
    student = models.Student(name=name, department_id=department_id)
    db.add(student)
    db.commit()
    db.refresh(student)
    return student


---

3ï¸âƒ£ JOINS in FastAPI (SQLAlchemy)

Letâ€™s understand joins clearly.

We have:

Department
id | name

Student
id | name | department_id


---

ðŸ”¹ 1. INNER JOIN

ðŸ‘‰ Returns only matching records.

@app.get("/inner-join/")
def inner_join(db: Session = Depends(get_db)):
    result = (
        db.query(models.Student, models.Department)
        .join(models.Department)
        .all()
    )
    return result

Meaning:

Only students who have valid department


SQL equivalent:

SELECT *
FROM students
INNER JOIN departments
ON students.department_id = departments.id;


---

ðŸ”¹ 2. LEFT JOIN (LEFT OUTER JOIN)

ðŸ‘‰ Returns all students, even if no department exists.

@app.get("/left-join/")
def left_join(db: Session = Depends(get_db)):
    result = (
        db.query(models.Student, models.Department)
        .outerjoin(models.Department)
        .all()
    )
    return result

SQL equivalent:

SELECT *
FROM students
LEFT JOIN departments
ON students.department_id = departments.id;


---

ðŸ”¹ 3. RIGHT JOIN

âš  SQLite does not support RIGHT JOIN directly.

But logically:

SELECT *
FROM students
RIGHT JOIN departments
ON students.department_id = departments.id;

In SQLAlchemy (simulate):

@app.get("/right-join/")
def right_join(db: Session = Depends(get_db)):
    result = (
        db.query(models.Department, models.Student)
        .outerjoin(models.Student)
        .all()
    )
    return result

ðŸ‘‰ Here we reverse the order.


---

ðŸ”¹ 4. FULL OUTER JOIN

Returns:

All students

All departments

Match where possible


SQLite doesn't support directly.

In PostgreSQL:

from sqlalchemy import select
from sqlalchemy.sql import join

j = join(models.Student, models.Department,
         models.Student.department_id == models.Department.id,
         full=True)


---

ðŸ”¹ 5. CROSS JOIN

Every student with every department.

@app.get("/cross-join/")
def cross_join(db: Session = Depends(get_db)):
    result = (
        db.query(models.Student, models.Department)
        .all()
    )
    return result

Equivalent SQL:

SELECT *
FROM students
CROSS JOIN departments;


---

ðŸ§  Quick Summary of Joins

Join Type	Returns

INNER JOIN	Only matching rows
LEFT JOIN	All left + matching right
RIGHT JOIN	All right + matching left
FULL JOIN	Everything
CROSS JOIN	Cartesian product



---

ðŸ”¥ Important for Interviews

When interviewer asks:

â“ What is difference between ForeignKey and relationship?

Answer:

ForeignKey â†’ Database level constraint

relationship â†’ ORM level object linking



---

ðŸ”¥ Real World Example

E-commerce:

User â†’ Orders

Order â†’ OrderItems

Product â†’ Category


All connected using Foreign Keys.


---

ðŸš€ Since you're building backend systems

For your resume-level projects (like SQL engine / system design):

Next level concepts:

One-to-Many

Many-to-Many (using association table)

Cascade delete

Lazy vs Eager loading

Indexing on foreign keys


If you want, next I can teach:

ðŸ‘‰ Many-to-Many with association table
ðŸ‘‰ Cascade delete example
ðŸ‘‰ Production-ready structure (models, schemas, CRUD layer)
ðŸ‘‰ How joins affect performance internally

Tell me what you want to go deep into ðŸ˜„


































Super ðŸ‘ good that you told me clearly.

Letâ€™s forget FastAPI code for 5 minutes.

First we understand with real records (actual data).
Then Iâ€™ll connect it back to FastAPI.

Weâ€™ll go very slowly.


---

ðŸ« Example: College Database

We have 2 tables:

ðŸŸ¢ Department Table

id	name

1	CSE
2	ECE
3	Mechanical



---

ðŸ”µ Student Table

id	name	department_id

1	Rahul	1
2	Sneha	1
3	Arjun	2
4	Kiran	NULL



---

1ï¸âƒ£ What is Primary Key?

Primary key = unique identifier.

In Department:

id â†’ Primary Key

In Student:

id â†’ Primary Key

No two rows can have same id.


---

2ï¸âƒ£ What is Foreign Key?

Look at this column:

Student.department_id

This refers to:

Department.id

So:

Rahul â†’ department_id = 1 â†’ CSE

Sneha â†’ department_id = 1 â†’ CSE

Arjun â†’ department_id = 2 â†’ ECE

Kiran â†’ NULL â†’ No department


ðŸ‘‰ That is called Foreign Key relationship

It creates a connection between tables.


---

ðŸŽ¯ What Type of Relationship Is This?

One Department â†’ Many Students

Example: CSE has:

Rahul

Sneha


This is called:

ðŸ”¹ One-to-Many Relationship


---

3ï¸âƒ£ Now Letâ€™s Understand JOINS Using Real Data

This is where confusion usually comes ðŸ˜„
So weâ€™ll go one by one.


---

ðŸ”µ INNER JOIN

ðŸ‘‰ "Give me only students who have department"

SQL:

SELECT students.name, departments.name
FROM students
INNER JOIN departments
ON students.department_id = departments.id;

Result:

student	department

Rahul	CSE
Sneha	CSE
Arjun	ECE


âŒ Kiran is NOT included (because department_id = NULL)


---

ðŸŸ¢ LEFT JOIN

ðŸ‘‰ "Give me ALL students, even if department not found"

SQL:

SELECT students.name, departments.name
FROM students
LEFT JOIN departments
ON students.department_id = departments.id;

Result:

student	department

Rahul	CSE
Sneha	CSE
Arjun	ECE
Kiran	NULL


âœ” Everyone from LEFT table (students)


---

ðŸŸ¡ RIGHT JOIN

ðŸ‘‰ "Give me ALL departments, even if no students"

Imagine this data:

Department table has:

id	name

1	CSE
2	ECE
3	Mechanical


No student in Mechanical.

RIGHT JOIN result:

student	department

Rahul	CSE
Sneha	CSE
Arjun	ECE
NULL	Mechanical


âœ” All departments included


---

ðŸ”´ FULL OUTER JOIN

ðŸ‘‰ "Give me everything"

All students

All departments

Match where possible


If:

One student has no department

One department has no students


Both will appear.


---

ðŸŸ£ CROSS JOIN

ðŸ‘‰ "Combine everything with everything"

If:

4 students

3 departments


Result rows = 4 Ã— 3 = 12 rows

Every student with every department.

This is rarely used normally.


---

ðŸ§  Why Do We Need Foreign Key?

Without foreign key:

You could insert:

id	name	department_id

5	Ajay	999


But department 999 doesnâ€™t exist âŒ

Foreign key prevents that.

It enforces data integrity.


---

ðŸ”¥ Now Letâ€™s Connect This to FastAPI (Simple)

In SQLAlchemy model:

department_id = Column(Integer, ForeignKey("departments.id"))

This tells database:

> This value must exist in departments table.



And this:

department = relationship("Department")

Lets you do:

student.department.name

Instead of manually joining.


---

ðŸŽ¯ Big Picture Concept

Think like this:

Database tables = Excel sheets
Foreign Key = One sheet referencing another sheet
Join = Combining sheets to see full data


---

ðŸ’¡ Very Important Interview Concept

Foreign Key = Constraint
Join = Query Operation

They are NOT same.

Foreign Key â†’ defines relationship
Join â†’ uses relationship to fetch data


---

ðŸš€ Since you're strong in backend logic

Let me ask you one thinking question:

If we delete CSE department,
what should happen to Rahul and Sneha?

1. Delete them?


2. Set department_id to NULL?


3. Throw error?



That concept is called CASCADE.

If you want next, Iâ€™ll explain:

Cascade delete clearly

Many-to-Many with real records

How joins work internally (execution plan)


Tell me which one you want next ðŸ˜„
